802.11-WEP加密

#### 什么是WEP

有线等效加密，故名思意，其目的就是就是让无线网络具有像有线网络一样的机密性。

WEP 是1999年9月通过的IEEE 802.11标准的一部分，使用 RC4串流加密技术。工作在无线接入的Authentication阶段，是802.11协议早期的一种加密方式，后来由于其安全性的瑕疵，逐渐被弃用。虽然是历史遗留的产品，但是其中的算法可以供后人学习。

#### WEP加密算法

##### 流密码

WEP采用流加密的方式，以字节流的方式来进行加密，如图，将明文序列和加密序列异或之后获得密文，解密的时候，再将密文和加密序列异或就可以得到明文。

![img](https://pic1.zhimg.com/v2-53090b939fff72d866b29a885581b25e_1440w.jpg)

而加密序列的生成依赖于一个种子，在无线连接中，依赖的种子是我们输入的密码，然后根据算法将 种子生成为一个加密序列

![img](https://pic1.zhimg.com/v2-001b7e7f29e2646745b0b2836d992d4e_1440w.jpg)

从图中可以看到，流加密的安全性主要取决于加密的算法，如果密钥序列的随机性不够或者加密序列和密钥种子的关系可以被统计分析出来，那么就可以破解这一个流加密算法。

##### RC4算法

WEP使用RC4算法来对字节流进行流加密，过程主要分为初始化，密钥调度和伪随机数生成。我们可以结合代码进行分析。

###### 名词约定

###### 初始化

按0-255的顺序填充一个数组S。

###### KSA密钥调度

根据密钥来对S数组进行 打乱。

###### PRGA伪随机数生成

输入一个字节，按照S对该

（这里怎么保证发送和接受对齐字节？

伪随机数生成是无限的，可以认为是一个generator。加密的时候以帧为单位，依次对帧内的数据，按照字节进行加密，完成一个帧的加密之后，generator归零，重新对下一个帧进行加密。）

#### WEP强制破解

##### 破解历史

##### 可行性分析

##### Klein攻击

##### PTW攻击

#### 参考资料

[密码分析学——深度分析WEP密钥恢复攻击（PTW攻击） - 知乎](https://zhuanlan.zhihu.com/p/57677761)

[加密解密算法之RC4 – 标点符](https://www.biaodianfu.com/rc4.html)